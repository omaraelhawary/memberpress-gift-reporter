(function($){"use strict";window.mpgrExportCSV=function(){var $btn=$(".mpgr-export-btn");var originalText=$btn.text();$btn.text("ðŸ“¥ Exporting...").prop("disabled",true);var formData=new FormData;formData.append("action","mpgr_export_csv");formData.append("nonce",mpgr_ajax.nonce);$.ajax({url:mpgr_ajax.ajax_url,type:"POST",data:formData,processData:false,contentType:false,xhrFields:{responseType:"blob"},success:function(response,status,xhr){var blob=new Blob([response],{type:"text/csv"});var url=window.URL.createObjectURL(blob);var a=document.createElement("a");a.style.display="none";a.href=url;a.download="memberpress_gift_report.csv";document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);$btn.text(originalText).prop("disabled",false);showMessage("CSV exported successfully!","success")},error:function(xhr,status,error){$btn.text(originalText).prop("disabled",false);showMessage("Error exporting CSV. Please try again.","error");console.error("Export error:",error)}})};function showMessage(message,type){var $message=$('<div class="mpgr-message mpgr-'+type+'">'+message+"</div>");$(".mpgr-gift-report").prepend($message);setTimeout(function(){$message.fadeOut(function(){$(this).remove()})},5e3)}$(document).ready(function(){$("<style>").prop("type","text/css").html(`
                .mpgr-message {
                    padding: 10px 15px;
                    margin: 10px 0;
                    border-radius: 4px;
                    font-weight: bold;
                }
                .mpgr-success {
                    background-color: #d4edda;
                    color: #155724;
                    border: 1px solid #c3e6cb;
                }
                .mpgr-error {
                    background-color: #f8d7da;
                    color: #721c24;
                    border: 1px solid #f5c6cb;
                }
            `).appendTo("head");$(document).on("click",".mpgr-export-btn",function(e){e.preventDefault();mpgrExportCSV()});$(".mpgr-table").on("load",function(){$(this).addClass("mpgr-loaded")});if($(window).width()<768){$(".mpgr-table").addClass("mpgr-mobile")}$(window).resize(function(){if($(window).width()<768){$(".mpgr-table").addClass("mpgr-mobile")}else{$(".mpgr-table").removeClass("mpgr-mobile")}})})})(jQuery);